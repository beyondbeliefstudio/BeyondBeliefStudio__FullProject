---
import {Picture} from "astro:assets";

const { items } = Astro.props;
---

<section class="projects" aria-label="Projects Gallery">
    <div class="container-md projects__container">
        <div class="content-full">
            <div class="projects__grid grid-auto-3">
                {items.map((item: { src: string; alt?: string; id?: string }) => (
                    <div class="projects__img-wrapper">
                        <Picture src={item.src} alt={item.alt ?? null} class="projects__img" id={item.id} loading="eager" width={2000} height={1000} />
                    </div>
                ))}
            </div>
        </div>
    </div>

    <!-- Gallery Modal -->
    <div id="gallery-modal" class="gallery-modal" style="display:none;">
        <span class="gallery-modal-close">&times;</span>
        <img id="gallery-modal-img" src="/" alt="Gallery Image" />
    </div>
</section>

<style lang="scss">
.projects {
    &__img-wrapper {
        overflow: hidden;
        border-radius: var(--border-radius-medium);
        cursor: pointer;
        aspect-ratio: 1/1;
    }
}
</style>


<script>
document.querySelectorAll('.projects__img-wrapper').forEach(item => {
  const img = item.querySelector('img');
  if (img) {
    img.addEventListener('click', function() {
      const modal = document.getElementById('gallery-modal');
      const modalImg = document.getElementById('gallery-modal-img');
      if (modal && modalImg && modalImg instanceof HTMLImageElement) {
        modalImg.src = img.src;
        modal.style.display = 'flex';
      }
    });
  }
});

const closeButton = document.querySelector('.gallery-modal-close');
if (closeButton) {
  closeButton.addEventListener('click', function() {
    const modal = document.getElementById('gallery-modal');
    if (modal) {
      modal.style.display = 'none';
    }
  });
}

const modal = document.getElementById('gallery-modal');
if (modal) {
  modal.addEventListener('click', function(e) {
    if (e.target === this) this.style.display = 'none';
  });
}
</script>